DEMO STEPS BLUE-GREEN
---------------------
---------------------

### PLEASE READ THE STEPS CAREFULLY 
### OFFICIAL DOC REFERENCE https://docs.openshift.com/container-platform/3.11/dev_guide/deployments/advanced_deployment_strategies.html

### DOCKER REGISTRY LOGIN 
docker login docker-registry-default.cloudapps.ocp.192.168.1.30.nip.io -u $(oc whoami) -p $(oc whoami -t)

### PUSHING DEVELOPED APPLICATIONS (V1 and V2) TO INTERNAL DOCKER REGISTRY

docker tag docker.io/giriraj789/green:v1 docker-registry-default.cloudapps.ocp.192.168.1.30.nip.io/openshift/deployment-example:v1
docker push docker-registry-default.cloudapps.ocp.192.168.1.30.nip.io/openshift/deployment-example:v1
docker tag docker.io/giriraj789/blue:v1 docker-registry-default.cloudapps.ocp.192.168.1.30.nip.io/openshift/deployment-example:v2
docker push docker-registry-default.cloudapps.ocp.192.168.1.30.nip.io/openshift/deployment-example:v2

###CREATE PROJECT
oc new-project blue-green-demo

### SPINING APPLICATION VERSION
oc new-app openshift/deployment-example:v1 --name=example-green -n blue-green-demo
oc new-app openshift/deployment-example:v2 --name=example-blue -n blue-green-demo

### ESTABLISHING NETWORKING 
oc expose svc/example-green --name=bluegreen-example

### USE ANY BROWSER AND TEST APPLICATION V1 (GREEN COLOUR) ACCESSIBILTY 
### http://bluegreen-example-blue-green-demo.cloudapps.ocp.192.168.1.30.nip.io/
###

### MOVING APPLICATION FROM V1 TO V2 
oc patch route/bluegreen-example -p '{"spec":{"to":{"name":"example-blue"}}}'

### USE ANY BROWSER AND TEST APPLICATION V2 (BLUE COLOUR) ACCESSIBILTY 
### http://bluegreen-example-blue-green-demo.cloudapps.ocp.192.168.1.30.nip.io/
###

### ROLL BACK APPLICATION FROM V2 to V1 After successful testing

oc patch route/bluegreen-example -p '{"spec":{"to":{"name":"example-green"}}}'

### USE ANY BROWSER AND TEST APPLICATION V1 (ROLL BACK TO BLUE COLOUR) ACCESSIBILTY 
### http://bluegreen-example-blue-green-demo.cloudapps.ocp.192.168.1.30.nip.io/
###

FINISH







STEPS 
------
### APPLICATON V1=BLUE COLOR
### APPLICATON V2=GREEN COLOR
oc new-project blue-green-demo
#APP version 1 which is of BLUE COLOR 
oc new-app openshift/blue:v1 --name=example-blue -n blue-green-demo
oc expose svc/example-blue --name=bluegreen-example
#APP version 2 which is of GREEN COLOR
oc new-app openshift/green:v1 --name=example-green -n blue-green-demo
## UPGRADE from V1 to V2 
oc patch route/bluegreen-example -p '{"spec":{"to":{"name":"example-green"}}}'
# ROLLBACK from V2 to V1  
oc patch route/bluegreen-example -p '{"spec":{"to":{"name":"example-blue"}}}'
